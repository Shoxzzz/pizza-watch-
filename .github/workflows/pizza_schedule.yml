name: Pentagon Pizza V10 (Hourly)

on:
  schedule:
    # ğŸ•’ æ ¸å¿ƒè®¾å®šï¼šæ¯å°æ—¶çš„ç¬¬ 0 åˆ†é’Ÿè¿è¡Œ (æ•´ç‚¹æŠ“å–)
    # ä¾‹å¦‚ï¼š8:00, 9:00, 10:00... (ä¼šæœ‰ GitHub å»¶è¿Ÿï¼Œæ­£å¸¸)
    - cron: '0 * * * *'
  
  # æ‰‹åŠ¨è§¦å‘æŒ‰é’® (æµ‹è¯•ç”¨)
  workflow_dispatch:

concurrency:
  group: pentagon-v10
  cancel-in-progress: true

permissions:
  contents: write

jobs:
  spy-job:
    runs-on: ubuntu-latest
    timeout-minutes: 20 # ç»™è¶³æ—¶é—´ï¼Œé˜²æ­¢ç½‘ç»œå¡é¡¿

    steps:
    - name: ğŸ“¥ æ‹‰å–ä»£ç 
      uses: actions/checkout@v4

    - name: ğŸ è®¾ç½® Python 3.10
      uses: actions/setup-python@v5
      with:
        python-version: '3.10' 
        cache: 'pip' # å¼€å¯ç¼“å­˜åŠ é€Ÿ

    - name: ğŸ“¦ å®‰è£…ä¾èµ–
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: ğŸ•µï¸â€â™‚ï¸ æ‰§è¡Œ V10 æŠ“å–
      env:
        # å¦‚æœæ‚¨é…ç½®äº† Discordï¼Œè¿™é‡Œä¼šç”¨åˆ°
        DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
      run: python -u monitor.py

    - name: ğŸ’¾ ä¿å­˜æ•°æ®
      run: |
        git config --global user.name "Pentagon Bot V10"
        git config --global user.email "bot@pentagon.ops"
        
        # å¼ºåˆ¶æ·»åŠ æ•°æ®æ–‡ä»¶
        git add pizza_data.csv || true
        
        # æäº¤ (å¸¦ä¸Šæ—¶é—´æˆ³)
        timestamp=$(date -u)
        git commit -m "INTEL UPDATE: $timestamp" || echo "âš ï¸ æ— æ–°æ•°æ®"
        
        git push
